{% extends "base.html" %}
{% block content %}

<section class="carrito-container">

    <h1 class="titulo-carrito">üõí Tu carrito de compras</h1>

    {% if cart_items and cart_items|length > 0 %}

    <div class="carrito-tabla-container">
        <table class="tabla-carrito">
            <thead>
                <tr>
                    <th>Producto</th>
                    <th>Precio</th>
                    <th>Cantidad</th>
                    <th>Subtotal</th>
                    <th></th>
                </tr>
            </thead>

            <tbody>
                {% for item in cart_items %}
                <tr>

                    <!-- PRODUCTO -->
                    <td class="producto-info">
                        <img src="{{ url_for('static', filename='img/' ~ item.imagen) }}"
                             class="img-carrito"
                             alt="{{ item.nombre }}">
                        <div class="detalle-producto">
                            <span class="nombre-producto">{{ item.nombre }}</span>
                            <small class="marca-producto">{{ item.marca }}</small>
                        </div>
                    </td>

                    <!-- PRECIO -->
                    <td class="precio-carrito">
                        ${{ item.precio }}
                    </td>

                    <!-- CANTIDAD -->
                    <td>
                        <form action="{{ url_for('update_cart', product_id=item._id) }}" method="POST" class="form-cantidad">
                            <input type="number" name="quantity" min="1" value="{{ item.quantity }}" class="input-cantidad">
                            <button type="submit" class="btn-actualizar">Actualizar</button>
                        </form>
                    </td>

                    <!-- SUBTOTAL -->
                    <td class="subtotal-carrito">
                        ${{ item.subtotal }}
                    </td>

                    <!-- ELIMINAR -->
                    <td>
                        <form action="{{ url_for('remove_from_cart', product_id=item._id) }}" method="POST">
                            <button type="submit" class="btn-eliminar">üóëÔ∏è</button>
                        </form>
                    </td>

                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- RESUMEN -->
    <div class="carrito-resumen">
        <h3>Total a pagar: <span class="precio-total">${{ total }}</span></h3>
        <a href="{{ url_for('checkout') }}" class="btn-comprar">Proceder al pago</a>
    </div>

    {% else %}

    <!-- CARRITO VAC√çO -->
    <div class="carrito-vacio">
        <p>üõçÔ∏è Tu carrito est√° vac√≠o</p>
        <a href="{{ url_for('index') }}" class="btn-volver">Volver a la tienda</a>
    </div>

    {% endif %}

</section>

{% endblock %}
